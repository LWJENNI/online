<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Розклад</title>
    <style>
        body {
            background-color: rgb(80, 141, 165);
        }

        .container {
            margin-top: 20px;
        }

        .dynamic-div {
            width: 100%;
            border-collapse: collapse;
        }

        .dynamic-div th,
        .dynamic-div td {
            padding: 10px;
            text-align: center;
            font-size: 20px;
        }

        .dynamic-div th {
            background-color: rgb(53, 157, 198);
            border-radius: 20px;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
        }

        select {
            background-color: rgb(35, 193, 207);
            border-radius: 10px;
            text-align: center;
        }

        .day-schedule {
            border-radius: 25px;
            margin: 10px 0;
            padding: 10px;
        }

        .lesson {
            border: 2px solid rgb(53, 157, 198);
            border-radius: 10px;
            padding: 10px;
            margin: 5px 0;
            background-color: rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            font-size: calc(100% + 10px);
        }

        .Monday.true {
            background: linear-gradient(to right, #3c8784, #34015b);
        }

        .Tuesday.true {
            background: linear-gradient(to right, #285b59, #6c0189);
        }

        .Wednesday.true {
            background: linear-gradient(to right, #274a49, #57036e);
        }

        .Thursday.true {
            background: linear-gradient(to right, #175755, #07015b);
        }

        .Friday.true {
            background: linear-gradient(to right, #112726, #01255b);
        }
        .Monday.false, .Tuesday.false, .Wednesday.false, .Thursday.false, .Friday.false {
            background-color: rgb(15, 106, 142);
        }

    </style>
</head>

<body>
    <main>
        <div style="background-color: rgb(22, 148, 198); border-radius: 25px; border: solid rgb(15, 106, 142); text-align: center; display: list-item;">
            <select name="date" id="date" style="margin: 10px 10px;">
                <option value="all-days" selected>Всі дні</option>
                <option value="Monday">Понеділок</option>
                <option value="Tuesday">Вівторок</option>
                <option value="Wednesday">Середа</option>
                <option value="Thursday">Четвер</option>
                <option value="Friday">П'ятниця</option>
            </select>
            <div class="version" id="version" style="background-color: rgb(22, 148, 198);"></div>
            <div>
                <label>
                    <input type="checkbox" id="checkbox" checked> градієнт
                </label>
            </div>
        </div>
    </main>
    <aside>
        <div class="container" id="schedule"></div>
    </aside>
    <footer>
        <div style="position: fixed; bottom: 20px; left: 50%; margin: 0px -130px; background-color: rgba(27, 96, 124, 0.5); padding: 10px; border-radius: 5px; z-index: 1000;">
            Це не фінальний результат, <br> і розклад може бути змінений.
        </div>
        <br>
        <br>
        <br>
        <br>
    </footer>
    <article>
        <div style="background-color: rgb(8, 96, 104); text-align: center; width: 35%;">
            Info
            <div id="info" class="info"></div>
        </div>
    </article>

    <script>
        const checkbox = document.getElementById('checkbox');
        let lists;

        function finish(data) {
            return new Promise((resolve, reject) => {
                const version = data.version;
                const currentDate = new Date();
                const formattedCurrentDate = currentDate.toISOString().slice(0, 10).replace(/-/g, '.');

                const startDate = data.date[0];
                const endDate = data.date[1];

                if (formattedCurrentDate >= startDate && formattedCurrentDate <= endDate) {
                    lists = data.list;
                    document.getElementById("version").innerHTML = "<p>Version Patch: " + version + "<br>Date: " + formattedCurrentDate + "</p>";
                    resolve(lists);
                    const size = lists.length;
                    document.getElementById("info").innerHTML = "date: " + startDate + " " + endDate + " " + formattedCurrentDate + "<br> patch: " + version + "<br> Size L: " + size;
                } else {
                    reject("Current Date is out of range.");
                }
            });
        }

        const send = 'https://raw.githubusercontent.com/LWJENNI/online/main/date.json';

        fetch(send)
            .then(response => response.json())
            .then(data => finish(data))
            .then(() => {
                main();
            })
            .catch(error => console.error(error));

        function main() {
            document.getElementById('date').addEventListener('change', updateContent);
            checkbox.addEventListener('change', updateContent);

            function updateContent() {
                const dayValue = document.getElementById('date').value;
                createScheduleTable(dayValue);
            }

            function translateDay(day) {
                const dayTranslations = {
                    "Monday": "Понеділок",
                    "Tuesday": "Вівторок",
                    "Wednesday": "Середа",
                    "Thursday": "Четвер",
                    "Friday": "П'ятниця"
                };
                return dayTranslations[day] || day;
            }

            function createScheduleTable(dayName) {
                const schedule = lists[0].class7;
                let result = "";

                const useGradient = checkbox.checked;

                if (dayName === "all-days") {
                    for (const [day, lessons] of Object.entries(schedule)) {
                        const translatedDay = translateDay(day);
                        result += `<div class='day-schedule ${day} ${useGradient ? "true" : "false"}'><h3>${translatedDay}</h3>`;
                        for (const json of Object.entries(lessons)) {
                            const value = json[1];
                            result += `<div class='lesson'><span>${value.time}</span><span>${value.text}</span></div>`;
                        }
                        result += "</div>";
                    }
                } else if (schedule[dayName]) {
                    const translatedDay = translateDay(dayName);
                    const lessons = schedule[dayName];
                    result += `<div class='day-schedule ${dayName} ${useGradient ? "true" : "false"}'><h3>${translatedDay}</h3>`;
                    for (const lesson of lessons) {
                        result += `<div class='lesson'><span>${lesson.time}</span><span>${lesson.text}</span></div>`;
                    }
                    result += "</div>";
                } else {
                    const translatedDay = translateDay(dayName);
                    result += `<div class='day-schedule ${dayName} ${useGradient ? "true" : "false"}'><h3>${translatedDay}</h3><p>Дані не знайдено для ${translatedDay}</p></div>`;
                }

                document.getElementById("schedule").innerHTML = result;
            }

            createScheduleTable("all-days");
        }
    </script>

</body>

</html>
